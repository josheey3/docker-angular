#!/usr/bin/with-contenv bash

cd /app || exit

if [ ! -f "/app/angular.json" ]; then
	npm install
	ng update
	npm update
	npm install -g --save typescript
	npm install -g --save @angular/cli
	npm install -g --save @angular-devkit/build-angular

	ng new my-angular-app
	shopt -s dotglob
	mv ./my-angular-app/* ./
	rm -rf ./my-angular-app
fi

exec \
	s6-setuidgid abc /usr/bin/ng serve
